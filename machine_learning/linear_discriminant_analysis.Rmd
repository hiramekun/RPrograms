---
title: "R Notebook"
output: html_notebook
author: Takaaki Hirano
---

# 線形判別器の実装

## 定数の宣言
```{r}
beta = pi / 4
sigma = matrix(c(
  sd1,
  8 * cos(beta) * sin(beta),
  8 * cos(beta) * sin(beta),
  sd2
), ncol = 2)

mu1 = c(2, 0)
mu2 = c(-2, 0)

alpha = 0.5
n = 600
n1 = sum(runif(600) < alpha)
n2 = n - n1
```

## 線形判別器
```{r}
a = solve(sigma) %*% (mu1 - mu2)
b = -1 / 2 * (t(mu1) %*% solve(sigma) %*% mu1 - t(mu2) %*% solve(sigma) %*% mu2) + log(n1 /
                                                                                         n2)
linear = function(x) {
  if (a[2] == 0) {
    rep(0, length(x))
  } else {
    -(a[1] / a[2]) * x + rep(b / a[2], length(x))
  }
}
```

## 決定境界の描画
```{r}
plot_graph = function() {
  
}
library(mvtnorm)

rand1 = rmvnorm(n = n1, mean = c(0, 2), sigma)
rand2 = rmvnorm(n = n2, mean = c(0, -2), sigma)

plot(
  rand1[, 1],
  rand1[, 2],
  xlab = "x",
  ylab = "y",
  xlim = c(-10, 10),
  ylim = c(-10, 10),
  col = "blue",
  pch = 20
)
par(new = T)
plot(
  rand2[, 1],
  rand2[, 2],
  xlab = "x",
  ylab = "y",
  xlim = c(-10, 10),
  ylim = c(-10, 10),
  col = "red",
  pch = 20
)

par(new = T)
if (a[2] == 0) {
  abline(v = 0)
} else{
  plot(
    -10:10,
    linear(-10:10),
    xlab = "x",
    ylab = "y",
    xlim = c(-10, 10),
    ylim = c(-10, 10),
    type = "l"
  )
}
```

## 決定境界のパラメータ
直線の傾きを決めるパラメータ
```{r}
a
```
定数項を決めるパラメータ
```{r}
b
```