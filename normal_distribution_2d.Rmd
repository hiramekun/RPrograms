---
title: "normal_distribution_2d"
output: html_document
author: takaaki hirano
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 2次元正規分布の描画
平均は、μ_1, μ_2ともに0とする
分散は、σ_1^2 = 2, σ_2^2 = 2
相関係数は、ρ_12 = 0.8と設定した。

### 2次元正規分布に従う散布図
```{r}
library(mvtnorm)
sigma.zero = matrix(c(2, 0.8, 0.8, 2), ncol = 2)
rand = rmvnorm(n = 1000, mean = c(0, 0), sigma.zero)
x1 = rand[, 1]
x2 = rand[, 2]
plot(x1, x2)
```


### 確率密度関数（答え）
```{r}
x1 = seq(-3, 3, length = 50)
x2 = x1
f = function(x1, x2) {
  dmvnorm(matrix(c(x1, x2), ncol = 2), mean = c(0, 0), sigma = sigma.zero)
}
z = outer(x1, x2, f)
z[is.na(z)] = 1
op = par(bg = "white")
persp(x1, x2, z, theta = 30, phi = 30, expand = 0.5, col = "orange")  
```

角度を変えて描画するとこんな感じになる。
```{r}
persp(x1, x2, z, theta = 60, phi = 60, expand = 0.5, col = "orange")  
```